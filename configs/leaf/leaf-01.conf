# Cumulus Linux Configuration for Leaf-01
# Hostname and basic configuration

# /etc/hostname
# leaf-01

# /etc/network/interfaces
auto lo
iface lo inet loopback
    address 10.0.0.21/32
    vxlan-local-tunnelip 10.0.0.21

# Leaf-01 to Spine-01 (swp51)
auto swp51
iface swp51
    address 10.1.1.1/31

# Leaf-01 to Spine-02 (swp52)
auto swp52
iface swp52
    address 10.1.1.5/31

# Bridge configuration for VXLAN
auto bridge
iface bridge
    bridge-ports vni10 vni20
    bridge-vlan-aware yes
    bridge-vids 10 20
    bridge-pvid 1

# VLAN 10
auto vlan10
iface vlan10
    address 192.168.10.1/24
    vlan-id 10
    vlan-raw-device bridge

# VLAN 20
auto vlan20
iface vlan20
    address 192.168.20.1/24
    vlan-id 20
    vlan-raw-device bridge

# VNI 10 (mapped to VLAN 10)
auto vni10
iface vni10
    vxlan-id 10010
    vxlan-local-tunnelip 10.0.0.21
    bridge-access 10
    bridge-learning off
    bridge-arp-nd-suppress on

# VNI 20 (mapped to VLAN 20)
auto vni20
iface vni20
    vxlan-id 10020
    vxlan-local-tunnelip 10.0.0.21
    bridge-access 20
    bridge-learning off
    bridge-arp-nd-suppress on

# /etc/frr/frr.conf
# FRR Configuration

frr version 8.0
frr defaults datacenter
hostname leaf-01
log syslog informational
service integrated-vtysh-config
!
# Router ID
router bgp 65101
 bgp router-id 10.0.0.21
 bgp bestpath as-path multipath-relax
 neighbor SPINE peer-group
 neighbor SPINE remote-as external
 neighbor SPINE capability extended-nexthop
 neighbor swp51 interface peer-group SPINE
 neighbor swp52 interface peer-group SPINE
 !
 address-family ipv4 unicast
  redistribute connected
  neighbor SPINE activate
 exit-address-family
 !
 address-family l2vpn evpn
  neighbor SPINE activate
  advertise-all-vni
 exit-address-family
!
line vty
!
